{
  "description": "Inputs\n------\ndefault: DataContainer\n    Any DataContainer - likely connected to the output of the OPEN_SERIAL node.",
  "parameters": [
    {
      "name": "connection",
      "type": "Serial",
      "description": "The open serial connection with the instrument."
    }
  ],
  "returns": [
    {
      "name": null,
      "type": "Scalar|TextBlob",
      "description": "The measured voltage as a Scalar or an exception error as a TextBlob."
    }
  ],
  "code": "import serial\nimport traceback\nfrom flojoy import flojoy, SerialConnection, TextBlob, Scalar, DataContainer\nfrom typing import cast, Optional\n\n\n@flojoy(deps={\"pyserial\": \"3.5\"}, inject_connection=True)\ndef MEASURE_VOLTAGE(\n    connection: SerialConnection, default: Optional[DataContainer] = None\n) -> Scalar | TextBlob:\n    \"\"\"The MEASURE_VOLTAGE node queries an instrument's measured output voltage, such as a DMM or power supply.\n\n    Inputs\n    ------\n    default: DataContainer\n        Any DataContainer - likely connected to the output of the OPEN_SERIAL node.\n\n    Parameters\n    ----------\n    connection: Serial\n        The open serial connection with the instrument.\n\n    Returns\n    -------\n    Scalar|TextBlob\n        The measured voltage as a Scalar or an exception error as a TextBlob.\n    \"\"\"\n\n    # Start serial communication with the instrument\n    ser = cast(serial.Serial, connection.get_handle())\n\n    if ser is None:\n        raise ValueError(\"Serial communication is not open\")\n\n    CMD = \"MEASURE:VOLTAGE:DC?\\n\\r\"\n\n    ser.write(CMD.encode())\n\n    resp = ser.readline().decode()\n\n    try:\n        resp = float(resp.rstrip(\"\\n\"))\n    except:\n        print(\n            \"Could not convert instrument response to a float\", traceback.format_exc()\n        )\n        return TextBlob(resp)\n\n    return Scalar(resp)\n"
}