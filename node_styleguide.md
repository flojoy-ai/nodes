# Python `NODE` style guide

## Docstrings

**Every node should have a docstring.** Docstring are used to generated the "Node description" preamble of a node's documentation page. 
Available node parameters should be spelled out using numpy's convention for list parameters:
```
Parameters
----------
x : type
    Description of parameter `x`.
y
    Description of parameter `y` (with type not specified).
```
(see https://numpydoc.readthedocs.io/en/latest/format.html#parameters)

Eventually, we may use the `Parameters` section of a node's docstring to auto-create the parameter manifest file. (@corinaldi is investigation)

Docstrings should with, "The x node ...", where x is the name of the node in all caps. For example:

```
The ADD node can be used to add 2 or more numeric arrays, matrices, dataframes, or constants element-wise. When a constant is added to an array or matrix, each element in the array or matrix will be increased by the constant value. If 2 arrays or matrices of different sizes are added, the output will be the size of the larger array or matrix with only the overlapping elements changed.
```

## Node naming

Node names should always appear in `ALL_CAPS`, using `code` styling when available. Words should be seperated with underscores. Because node names need to appear on node GUI elements, node name length should be optimized for shortness and never more than 20 characters.
- Node function name, Node file name and Node key in the manifest file must be the same. Because it helps studio frontend to construct correct GitHub path for each node.
- Folders in nodes directory should not contain any space. Words should be separated by using `_` underscore.
- The category folder name should follow it's key from [`COMMAND_TREE` here](https://github.com/flojoy-io/studio/blob/develop/src/utils/ManifestLoader.ts#L89)

## Ease of use

Nodes should be forgiving in terms of their input and ouutput parameters. Flojoy's target audience is engineers and technicians who may not know anything about Python - we want to create a productive, supportive UX for them.

### Weak typing

The first arg that the @flojoy decorator injects into a node function is always a `DataContainer` object with a `type` key set to one of the following:
- `ordered_pair`
- `ordered_triplet`
- `image` (a color image encoded in 3 R/G/B matrices)
- `greyscale` (a greyscale image incoded in 1 matrix)
- `timeseries`
- `constant` (TODO: rename to `scalar`)
- `matrix` (eg, from numpy)
- `dataframe` (eg, from pandas)
- `plotly` (a plotly object)

Nodes should try to accomodate any reasonable combination of inputs that a first-time Flojoy Studio user might try. 

For example, the `ADD` node should make a best effort to do something reasonable when a matrix is added to a dataframe, or a 2 matrices of a different size are added.

### Variable number of inputs

Where possible and reasonable, nodes should be able to accept a variable number of inputs. For example, the `ADD` node should be able to accept 2-N inputs.

## Code style

When finished writing your node, please use `black` (https://github.com/psf/black) and PEP8 to ensure code style uniformity and readability between nodes.

## Node categories

Node categories (such as DATA > GENERATORS > SIMULATION) should always be in ALL_CAPS with underscores seperating words. Categories may change and shift as more nodes are added to the standard corpus.

There are 2 top-level node categories:
- Standard nodes (manually written by humans)
- Library nodes (machine generated by introspection of Python libraries like numpy, sklearn, etc)

## Visualization and control nodes

Unlike other nodes, visualization and control nodes require adding a component on the frontend to display the visualization object or control widget. In other words, they require working knowledge of Typescript/React in addition to Python.





